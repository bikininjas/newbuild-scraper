# Project Context & Status: newbuild-scraper

## Goal
The goal of this project is to build a Python-based price tracker and HTML report generator for PC components. It scrapes prices from multiple e-commerce sites, tracks historical prices, and generates a modern HTML dashboard with product cards, price graphs, and summary tables. The UI should be clean, readable, and focused on the most relevant information for users.

## Current Features
- Scrapes prices from multiple sites (Amazon, Idealo, LDLC, TopAchat, etc.)
- Tracks historical prices in a CSV file
- Generates HTML output with:
  - Product cards (name, best price, links)
  - Price history graphs (Chart.js)
  - Summary table of best prices per category
  - Total price evolution graph
- Uses Tailwind CSS for styling
- Dates are formatted in French
- Graphs are visually compact (height 60px)

## Recent Issues & Difficulties
- **Historical Prices Section:** Despite multiple attempts, the historical prices list is still rendered in the HTML output. This section is generated by the `render_product_cards` function, which is imported from another module. Attempts to monkey-patch or regex-filter this output have not fully succeeded, as the HTML structure may vary or the function may render the section in a way that is hard to filter reliably.
- **Code Duplication:** There were duplicate helper functions and logic blocks, which have been cleaned up.
- **Cognitive Complexity:** Some functions (e.g., `build_product_prices`, `main`) are flagged as too complex by linters, but this does not block runtime.
- **French Date Formatting:** Locale-based formatting was replaced with a manual month mapping for portability.
- **Graph Sizing:** Graph heights are now enforced via both HTML and CSS.

## What's Missing / Next Steps
- **Remove Historical Prices Section:** The main unresolved issue is fully hiding the historical prices list from the HTML output. This requires either:
  - Refactoring the `render_product_cards` function in its source module to add a flag or option to hide the section, or
  - More robust HTML post-processing to reliably remove the section after rendering.
- **Documentation:** README and project documentation should be updated to reflect the current UI and known issues.
- **Further Refactoring:** Reduce cognitive complexity in main logic functions for maintainability.
- **Testing:** Confirm that all UI changes are reflected in the output and that the code runs cleanly.

## Prompt for Next AI Agent
You are an AI developer working on the `newbuild-scraper` project. Your goal is to:
- Ensure the HTML output is clean, modern, and focused (no historical price lists, only summary and product cards)
- Fix the issue where the historical prices section is still rendered in product cards
- Refactor code for maintainability and clarity
- Update documentation to reflect the current state and known issues

**Current blockers:**
- The historical prices section is still present in the HTML output due to limitations in the imported `render_product_cards` function. Attempts to filter or monkey-patch have not fully succeeded.

**Your next steps:**
- Refactor or override `render_product_cards` to allow hiding the historical prices section
- Ensure all UI requirements are met
- Document any further issues or blockers

---

This markdown file summarizes the project status, goals, issues, and next steps for any future AI agent or developer.
